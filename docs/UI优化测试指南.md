# UI优化测试指南

## 文档信息

- **项目**: 简记账 iOS App
- **创建日期**: 2026-01-26
- **测试版本**: UI优化完成版

---

## 测试准备

### 1. 在Xcode中打开项目

```bash
cd /Users/long/OpenSource/jizhang_ios/jizhang
open jizhang.xcodeproj
```

### 2. 选择模拟器

推荐测试设备:
- iPhone SE (第3代) - 小屏
- iPhone 15 Pro - 标准屏
- iPhone 15 Pro Max - 大屏

### 3. 编译运行

1. 选择目标: jizhang
2. 选择设备: iPhone 15 Pro模拟器
3. 按 `Cmd + B` 编译
4. 按 `Cmd + R` 运行

---

## 核心功能测试清单

### Phase 1: 基础视觉验证 ✅

#### 测试点
- [ ] 卡片圆角是否为16-20pt
- [ ] 卡片内边距是否宽松(20-24pt)
- [ ] 金额显示是否使用等宽数字
- [ ] 金额字号是否足够大(52pt/30pt/20pt)

#### 操作步骤
1. 启动App,查看首页
2. 观察净资产卡片的圆角和内边距
3. 观察金额数字,切换数据验证是否跳动
4. 对比优化前后的视觉效果

---

### Phase 2: 分类图标测试 ✅

#### 测试点
- [ ] 分类图标是否为圆形
- [ ] 图标背景色是否正确
- [ ] 图标是否为白色
- [ ] 选中状态是否有蓝色边框
- [ ] 阴影效果是否明显

#### 操作步骤
1. 点击首页右下角 + 按钮
2. 查看分类选择器
3. 验证5列网格布局
4. 点击不同分类,观察选中效果
5. 检查图标颜色映射是否正确

#### 预期效果
- 三餐: 橙色背景(#FFB74D)
- 交通: 蓝色背景(#64B5F6)
- 旅行: 绿色背景(#81C784)
- ... (共22种)

---

### Phase 3: 背景图片测试 ✅

#### 测试点
- [ ] 背景图片是否正确加载
- [ ] 半透明遮罩是否有效
- [ ] 毛玻璃卡片在背景上是否可读
- [ ] Dark Mode切换是否正常
- [ ] 自定义背景上传是否工作

#### 操作步骤

**基础测试**:
1. 进入: 设置 → 背景设置
2. 检查"启用背景图片"开关
3. 查看预览区域
4. 浏览预设背景
5. 选择不同背景,观察首页效果

**自定义上传测试**:
1. 点击"上传自定义背景"
2. 从相册选择图片
3. 验证图片是否成功保存
4. 检查自定义背景是否出现在列表
5. 选择自定义背景查看效果

**高级设置测试**:
1. 调整"遮罩透明度" (0-50%)
2. 观察文字可读性变化
3. 调整"模糊程度" (0-10)
4. 观察背景模糊效果

**Dark Mode测试**:
1. 切换到深色模式(设置 → 显示与亮度)
2. 观察背景遮罩是否自动加深
3. 验证文字对比度是否足够

---

### Phase 4: 首页优化测试 ✅

#### 测试点
- [ ] 净资产卡片使用GlassCard
- [ ] 隐藏/显示金额功能
- [ ] 本月收支显示正确
- [ ] 今日支出卡片显示
- [ ] 预算进度条正常
- [ ] 流水列表圆形图标

#### 操作步骤

**净资产卡片**:
1. 查看首页第一个卡片
2. 验证毛玻璃效果
3. 点击眼睛图标测试隐藏/显示
4. 观察金额字号(52pt)
5. 检查收支分隔线

**今日支出卡片**:
1. 查看今日支出金额
2. 观察预算进度条
3. 验证颜色状态(绿/橙/红)
4. 检查剩余金额显示

**流水列表**:
1. 滚动查看流水记录
2. 验证圆形分类图标(44pt)
3. 检查账户名 • 备注格式
4. 观察金额颜色(红/绿)

---

### Phase 5: 记账功能测试 ✅

#### 测试点
- [ ] 计算器键盘布局正确
- [ ] 金额输入流畅
- [ ] 加减运算正常
- [ ] 小数点处理正确
- [ ] 触觉反馈明显
- [ ] 分类选择器5列布局

#### 操作步骤

**添加支出**:
1. 点击首页右下角蓝色 + 按钮
2. 验证Sheet弹出
3. 点击金额区域唤起键盘
4. 输入数字,感受触觉反馈
5. 测试加减运算
6. 测试小数点输入
7. 点击分类,验证圆形图标
8. 选择账户、日期、备注
9. 点击确认添加

**添加收入**:
1. 切换到"收入"标签
2. 重复上述步骤
3. 验证收入分类图标

---

### Phase 6: 报表功能测试 ✅

#### 测试点
- [ ] 收支趋势图渐变色
- [ ] 饼图环形显示
- [ ] 中心金额显示
- [ ] 点击交互选择
- [ ] 图表动画流畅

#### 操作步骤

**收支图表**:
1. 切换到"报表"标签
2. 查看收支趋势图
3. 验证渐变色填充
4. 检查圆角柱子(4pt)
5. 观察Y轴智能格式化

**分类饼图**:
1. 滚动到分类分析部分
2. 验证环形图(中空60%)
3. 观察中心总金额显示
4. 点击饼图扇区
5. 验证选中分类信息显示
6. 观察未选中扇区渐隐效果

**汇总卡片**:
1. 查看顶部汇总卡片
2. 验证GlassCard效果
3. 检查收入/支出/结余三栏
4. 观察箭头图标

---

### Phase 7: 预算功能测试 ✅

#### 测试点
- [ ] 预算卡片GlassCard效果
- [ ] 圆形分类图标
- [ ] 状态边框颜色
- [ ] 进度条渐变
- [ ] 已用/剩余显示

#### 操作步骤

**创建预算**:
1. 切换到"预算"标签(或从设置进入)
2. 点击 + 创建预算
3. 选择分类(餐饮)
4. 输入预算金额(2000)
5. 保存

**预算卡片验证**:
1. 查看预算卡片列表
2. 验证圆形图标(40pt)
3. 检查状态边框:
   - 绿色: < 80%
   - 橙色: 80-99%
   - 红色: ≥ 100%
4. 观察进度条渐变
5. 验证已用/剩余金额

**预算进度**:
1. 添加几笔该分类的支出
2. 返回预算页面
3. 观察进度条动画
4. 验证百分比和剩余天数

---

### Phase 8: 设置页面测试 ✅

#### 测试点
- [ ] "外观"分组存在
- [ ] "背景设置"入口正常
- [ ] 图标颜色正确(粉色)

#### 操作步骤
1. 切换到"设置"标签
2. 验证"外观"section在顶部
3. 点击"背景设置"
4. 验证跳转到背景设置页面

---

### Phase 9: 动画交互测试 ✅

#### 测试点
- [ ] 按钮点击缩放反馈
- [ ] 触觉反馈明显
- [ ] 数字滚动动画
- [ ] 进度条弹性动画

#### 操作步骤

**触觉反馈**:
1. 点击各种按钮,感受震动
2. 点击FAB按钮(中等震动)
3. 选择分类(轻震动)
4. 保存交易(成功震动)
5. 删除操作(重震动)

**按钮动画**:
1. 按住任意按钮
2. 观察缩放到92-95%
3. 释放时弹回

**数字滚动**:
1. 添加一笔支出
2. 观察净资产数字滚动
3. 观察今日支出数字变化
4. 切换隐藏/显示金额

**进度条动画**:
1. 添加预算类别的支出
2. 观察进度条弹性增长
3. 验证颜色渐变效果

---

### Phase 10: 其他页面测试 ✅

#### 流水列表

测试步骤:
1. 切换到"流水"标签
2. 验证月份选择器
3. 测试类型筛选(全部/支出/收入)
4. 使用搜索功能
5. 验证圆形图标(44pt)
6. 左滑删除测试

#### 账本管理

测试步骤:
1. 设置 → 账本管理
2. 验证圆形账本图标(48pt)
3. 点击账本,查看菜单
4. 创建新账本
5. 切换默认账本

#### 账户管理

测试步骤:
1. 设置 → 账户管理
2. 验证圆形账户图标(44pt)
3. 检查资产/负债分组
4. 验证余额等宽显示
5. 创建信用卡账户
6. 查看可用额度显示

#### 分类管理

测试步骤:
1. 设置 → 分类管理
2. 切换支出/收入分类
3. 验证父分类圆形图标(40pt)
4. 展开父分类查看子分类
5. 验证子分类圆形图标(32pt)
6. 创建新分类

---

## 视觉对比测试

### 对比项目

创建一个测试checklist:

| 优化项 | 优化前 | 优化后 | 通过 |
|-------|-------|-------|------|
| 卡片圆角 | 12pt | 16-20pt | [ ] |
| 卡片内边距 | 12-16pt | 20-24pt | [ ] |
| 净资产字号 | 34pt | 52pt | [ ] |
| 分类图标 | 方形透明 | 圆形彩色 | [ ] |
| 图标尺寸 | 32-36pt | 44-48pt | [ ] |
| 进度条 | 纯色 | 渐变色 | [ ] |
| 背景 | 纯色 | 可选图片 | [ ] |
| 数字字体 | 标准 | 等宽 | [ ] |

---

## 性能测试

### 1. 滑动流畅度

**测试方法**:
1. 在首页快速滚动
2. 在流水列表页快速滚动
3. 观察是否卡顿
4. 检查帧率(目标:60fps)

**工具**: Xcode Instruments - Time Profiler

### 2. 背景图片加载

**测试方法**:
1. 切换不同背景图片
2. 记录加载时间
3. 观察内存占用
4. 验证缓存机制

**预期**:
- 加载时间: < 200ms
- 内存占用: < 50MB

### 3. 动画性能

**测试方法**:
1. 快速点击多个按钮
2. 连续添加多笔交易
3. 快速切换账本
4. 观察动画是否掉帧

**工具**: Xcode Instruments - Core Animation

---

## Dark Mode测试

### 测试步骤

1. **切换Dark Mode**:
   - 设置 → 显示与亮度 → 深色

2. **验证项目**:
   - [ ] 毛玻璃效果自动适配
   - [ ] 文字对比度足够
   - [ ] 背景遮罩加深20%
   - [ ] 图标颜色可见
   - [ ] 卡片边框可见

3. **重点检查**:
   - 净资产卡片
   - 今日支出卡片
   - 分类图标
   - 图表显示
   - 预算卡片

---

## 多设备适配测试

### iPhone SE (小屏)

**重点测试**:
- [ ] 金额是否自动缩放
- [ ] 分类网格是否适配
- [ ] 卡片间距是否合理
- [ ] 文字是否截断

### iPhone 15 Pro (标准)

**重点测试**:
- [ ] 整体布局协调
- [ ] 视觉比例合理
- [ ] 圆角大小适中

### iPhone 15 Pro Max (大屏)

**重点测试**:
- [ ] 利用大屏空间
- [ ] 金额显示不过小
- [ ] 图标大小合适

---

## 交互测试

### 触觉反馈

**测试场景**:
| 操作 | 预期反馈 | 通过 |
|------|---------|------|
| 点击普通按钮 | 轻触 | [ ] |
| 点击FAB按钮 | 中触 | [ ] |
| 选择分类 | 轻触 | [ ] |
| 切换Tab | 选择反馈 | [ ] |
| 保存交易 | 成功反馈 | [ ] |
| 删除交易 | 重触 | [ ] |
| 计算器数字 | 轻触 | [ ] |
| 计算器运算 | 中触 | [ ] |

**验证方法**: 静音模式下仍能感受到震动

### 动画流畅性

**测试场景**:
1. 按钮缩放(0.92-0.95)
2. 进度条增长(spring动画)
3. 数字滚动(30帧)
4. Sheet弹出/关闭
5. 页面切换

**验证方法**: 慢动作录屏,检查是否丝滑

---

## 数据验证

### 1. 金额计算准确性

**测试**:
- [ ] 添加支出,余额减少
- [ ] 添加收入,余额增加
- [ ] 转账,双方余额正确变化
- [ ] 预算计算正确
- [ ] 统计数据准确

### 2. 数字显示格式

**验证**:
- [ ] 千位分隔符正确(1,234.56)
- [ ] 小数点后2位
- [ ] 等宽数字不跳动
- [ ] 货币符号显示

---

## 已知问题排查

### 可能的问题

1. **背景图片未显示**
   - 检查Assets.xcassets/Backgrounds/是否有图片
   - 验证图片名称是否匹配
   - 检查"启用背景图片"是否开启

2. **分类图标颜色错误**
   - 检查CategoryIconConfig映射
   - 验证Category.colorHex值
   - 检查Color(hex:)初始化

3. **触觉反馈无效**
   - 检查设备是否支持(真机)
   - 模拟器不支持触觉反馈
   - 检查HapticManager引用

4. **动画卡顿**
   - 检查背景图片大小
   - 减少同时运行的动画
   - 优化列表渲染

---

## 性能优化建议

### 如果遇到性能问题

1. **背景图片优化**:
```swift
// 压缩图片
if let data = image.jpegData(compressionQuality: 0.6) {
    // 保存
}
```

2. **列表懒加载**:
```swift
// 已使用LazyVStack/LazyVGrid
```

3. **减少重绘**:
```swift
// 使用.id()强制重建
// 避免在body中创建复杂对象
```

---

## 测试报告模板

### 基础信息

- 测试人员: _______
- 测试日期: _______
- 测试设备: _______
- iOS版本: _______

### 测试结果

| Phase | 功能 | 通过 | 问题 |
|-------|------|------|------|
| 1 | 基础视觉 | [ ] | |
| 2 | 分类图标 | [ ] | |
| 3 | 背景图片 | [ ] | |
| 4 | 首页优化 | [ ] | |
| 5 | 记账功能 | [ ] | |
| 6 | 报表图表 | [ ] | |
| 7 | 预算功能 | [ ] | |
| 8 | 设置页面 | [ ] | |
| 9 | 动画交互 | [ ] | |
| 10 | 其他页面 | [ ] | |

### 发现的问题

1. 问题描述: _______
   - 重现步骤: _______
   - 预期行为: _______
   - 实际行为: _______

---

## 下一步

### 如果测试通过

1. 提交代码到git
2. 创建TestFlight版本
3. 邀请内部测试
4. 收集反馈

### 如果发现问题

1. 记录问题详情
2. 截图/录屏
3. 创建Issue
4. 修复并重新测试

---

## 联系方式

如有问题或建议,请联系开发团队。

**文档状态**: ✅ 完成  
**最后更新**: 2026-01-26
